
  \begin{figure}[th]
    \begin{minipage}[b]{0.45\linewidth}
      \begin{center}
        \begin{tikzpicture}[scale = 0.4,
            transform shape,
            msglabel/.style    = { text = Black, yshift = .3cm,
                                   sloped, midway },
            okmsg/.style       = { ->, color = MidnightBlue, thick,
                                   >=stealth },
            rstmsg/.style      = { ->, color = BrickRed, thick,
                                   >=stealth }
          ]
          \node[draw = MidnightBlue,
            fill = CornflowerBlue,
            minimum width = .3cm,
            minimum height = 10cm
          ] (h1) at (-4, 0) {};
          \node[draw = MidnightBlue,
            fill = CornflowerBlue,
            minimum width = .3cm,
            minimum height = 10cm
          ] (h2) at (4, 0) {};
          \node[above = 0cm of h1] {Merchant};
          \node[above = 0cm of h2] {Exchange};

          \path[->, color = MidnightBlue, very thick, >=stealth]
            (-5, 4.5) edge
            node[rotate=90, text = Black, yshift = .3cm] {Time}
            (-5, -4.5);
          \path[->, color = MidnightBlue, thick, >=stealth]
            ($(h1.east)+(0,3)$) edge
            node[text = Black, yshift = .3cm, sloped] {$S_{DK}(C), S_{c}(D)$}
            ($(h2.west)+(0,2)$);
          \path[->, color = MidnightBlue, thick, >=stealth]
            ($(h2.west)+(0,0.5)$) edge
            node[text = Black, yshift = .3cm, sloped] {200 OK: $S_{SK}(S_{c}(D))$}
            ($(h1.east)+(0,-0.5)$);
          \path[rstmsg]
            ($(h2.west)+(0, -2.5)$) edge
            node[msglabel] {409 CONFLICT: $S_{c}(D')$}
            ($(h1.east)+(0, -3.5)$);
          \node at (5.3, 0) {};
        \end{tikzpicture}
      \end{center}
    \end{minipage}
    \hspace{0.5cm}
    \begin{minipage}[b]{0.45\linewidth}
      \tiny
      \begin{description}
      \item[$DK$] Denomination key
      \item[$S_{DK}()$] RSA-FDH signature using $DK$
      \item[$c$] Private coin key, $C := cG$.
      \item[$S_{C}()$] EdDSA signature using $c$
      \item[$D$] Deposit details
      \item[$SK$] Exchange's signing key
      \item[$S_{SK}()$] EdDSA signature using $SK$
      \item[$D'$] Conficting deposit details $D' \not= D$
      \end{description}
    \end{minipage}
  \end{figure}

